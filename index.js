// إنشاء الخريطة وتحديد مركزها
var map = L.map('map').setView([23.8859, 45.0792], 2); // مركز العالم

// إضافة طبقة الخريطة
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '© OpenStreetMap contributors'
}).addTo(map);
var cities = {
  // 🔹 الشرق الأوسط
  "الرياض، السعودية":       { lat: 24.7136, lon: 46.6753, risk: 0.1 },
  "جدة، السعودية":          { lat: 21.4858, lon: 39.1925, risk: 1.2 },
  "مكة، السعودية":          { lat: 21.3891, lon: 39.8579, risk: 1.0 },
  "المدينة، السعودية":      { lat: 24.5247, lon: 39.5692, risk: 0.8 },
  "أبها، السعودية":         { lat: 18.2465, lon: 42.5126, risk: 0.3 },
  "الدمام، السعودية":       { lat: 26.4333, lon: 50.1033, risk: 0.0 },
  "طهران، إيران":           { lat: 35.6892, lon: 51.3890, risk: 5.6 },
  "كابل، أفغانستان":        { lat: 34.5553, lon: 69.2075, risk: 5.1 },
  "بيروت، لبنان":           { lat: 33.8938, lon: 35.5018, risk: 2.2 },
  "دمشق، سوريا":            { lat: 33.5138, lon: 36.2765, risk: 2.5 },
  "عمان، الأردن":           { lat: 31.9454, lon: 35.9284, risk: 1.9 },
  "بغداد، العراق":          { lat: 33.3152, lon: 44.3661, risk: 1.1 },
  "صنعاء، اليمن":           { lat: 15.3694, lon: 44.1910, risk: 0.6 },
  "مسقط، عمان":             { lat: 23.5880, lon: 58.3829, risk: 0.4 },

  //  آسيا
  "طوكيو، اليابان":         { lat: 35.6762, lon: 139.6503, risk: 12.5 },
  "جاكرتا، إندونيسيا":      { lat: -6.2088, lon: 106.8456, risk: 9.3 },
  "كاتماندو، نيبال":        { lat: 27.7172, lon: 85.3240, risk: 5.9 },
  "كويزون، الفلبين":        { lat: 14.6760, lon: 121.0437, risk: 6.2 },
  "هانوي، فيتنام":          { lat: 21.0285, lon: 105.8542, risk: 2.8 },
  "كابل، أفغانستان":        { lat: 34.5553, lon: 69.2075, risk: 5.1 },
  "طهران، إيران":           { lat: 35.6892, lon: 51.3890, risk: 5.6 },
  "إسلام آباد، باكستان":    { lat: 33.6844, lon: 73.0479, risk: 4.3 },
  "بنغلور، الهند":          { lat: 12.9716, lon: 77.5946, risk: 2.1 },
  "كولومبو، سريلانكا":      { lat: 6.9271, lon: 79.8612, risk: 1.4 },
  "بانكوك، تايلاند":        { lat: 13.7563, lon: 100.5018, risk: 1.7 },
  "كوالالمبور، ماليزيا":    { lat: 3.1390, lon: 101.6869, risk: 1.2 },
  "سنغافورة":               { lat: 1.3521, lon: 103.8198, risk: 0.9 },

  //  أوروبا
  "إسطنبول، تركيا":         { lat: 41.0082, lon: 28.9784, risk: 4.7 },
  "أثينا، اليونان":         { lat: 37.9838, lon: 23.7275, risk: 4.2 },
  "روما، إيطاليا":          { lat: 41.9028, lon: 12.4964, risk: 3.5 },
  "كويبيك، كندا":           { lat: 46.8139, lon: -71.2080, risk: 1.9 },

  //  أمريكا
  "لوس أنجلوس، أمريكا":     { lat: 34.0522, lon: -118.2437, risk: 7.8 },
  "سانتياغو، تشيلي":        { lat: -33.4489, lon: -70.6693, risk: 10.1 },
  "مكسيكو سيتي، المكسيك":   { lat: 19.4326, lon: -99.1332, risk: 6.8 },
  "بورت أو برنس، هايتي":    { lat: 18.5944, lon: -72.3074, risk: 3.9 },

  //  أوقيانوسيا
  "كرايستشيرش، نيوزيلندا":  { lat: -43.5321, lon: 172.6362, risk: 4.9 },
  "أوكلاند، نيوزيلندا":     { lat: -36.8485, lon: 174.7633, risk: 2.5 },

  //  أفريقيا
  "الجزائر، الجزائر":       { lat: 36.7538, lon: 3.0588, risk: 2.7 },
  "الرباط، المغرب":         { lat: 34.0209, lon: -6.8416, risk: 1.5 },
  "تونس، تونس":             { lat: 36.8065, lon: 10.1815, risk: 1.8 },
  "أديس أبابا، إثيوبيا":    { lat: 9.0300, lon: 38.7400, risk: 2.1 }
};

// إضافة علامات المدن
for (var city in cities) {
  var data = cities[city];
  var color = data.risk > 7 ? 'red' : data.risk >= 3 ? 'orange' : 'green';

  var marker = L.circleMarker([data.lat, data.lon], {
    radius: 10,
    color: color,
    fillColor: color,
    fillOpacity: 0.7
  }).addTo(map);

  marker.bindPopup(`<b>${city}</b><br>نسبة خطر الزلازل: ${data.risk}%`);

  // تنبيه إذا كانت المدينة ذات خطر مرتفع
  (function(cityName, cityData) {
    marker.on('click', function () {
      if (cityData.risk > 7) {
        alert(`⚠️ تنبيه: ${cityName} تعتبر منطقة ذات خطر زلزالي مرتفع! نسبة الخطر ${cityData.risk}%`);
      }
    });
  })(city, data);
}
